"0","## Grid and Transition matrix function of Rouwenhorst's Method"
"0","rouwen <- function(rho, sigma, n){"
"0","  "
"0","  zgrid <- seq("
"0","    from = - (sig / sqrt(1-rho^2)) * sqrt(N-1),"
"0","    to = + (sig / sqrt(1-rho^2)) * sqrt(N-1),"
"0","    length = n"
"0","  )"
"0",""
"0","  p  <- (rho+1)/2"
"0","  nu <- ((n-1)/(1-rho^2))^(1/2) * sigma"
"0","  P  <- matrix(c(p, 1 - p, 1 - p, p), nrow = 2, ncol = 2)"
"0","  "
"0","  for (i in 3:n){"
"0","    zeros <- matrix(0, nrow = i-1, ncol = 1)"
"0","    zzeros <- matrix(0, nrow = 1, ncol = i-1)"
"0","    "
"0","    P        <- p * rbind(cbind(P, zeros), cbind(zzeros, 0)) + "
"0","               (1-p) * rbind(cbind(zeros, P), cbind(0, zzeros)) + "
"0","               (1-p) * rbind(cbind(zzeros, 0), cbind(P, zeros)) + "
"0","                p * rbind(cbind(0, zzeros), cbind(zeros, P))"
"0","  }"
"0","  "
"0","  for (j in 1:N){"
"0","    P[j,] = P[j,]/sum(P[j,])"
"0","  }"
"0","  "
"0","  return(list(zgrid = round(zgrid, 4), P = round(P, 4)))"
"0","}"
"0",""
"0","## Grid and Transition matrix (Rouwenhorst's Method)"
"0","Rouwen95 <- rouwen(rho, sig, N)"
"0","Rouwen95"
"1","$zgrid
"
"1","[1]"
"1"," -0.0634"
"1"," -0.0476"
"1"," -0.0317"
"1"," -0.0159"
"1","  0.0000"
"1","  0.0159"
"1","  0.0317"
"1","  0.0476"
"1","  0.0634"
"1","
"
"1","
"
"1","$P
"
"1","     "
"1","   [,1]"
"1","   [,2]"
"1","   [,3]"
"1","   [,4]"
"1","   [,5]"
"1","   [,6]"
"1","   [,7]"
"1","   [,8]"
"1","   [,9]"
"1","
 [1,]"
"1"," 0.8167"
"1"," 0.1675"
"1"," 0.0150"
"1"," 0.0008"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [2,]"
"1"," 0.0209"
"1"," 0.8204"
"1"," 0.1469"
"1"," 0.0113"
"1"," 0.0005"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [3,]"
"1"," 0.0005"
"1"," 0.0420"
"1"," 0.8231"
"1"," 0.1261"
"1"," 0.0081"
"1"," 0.0003"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [4,]"
"1"," 0.0000"
"1"," 0.0016"
"1"," 0.0630"
"1"," 0.8247"
"1"," 0.1051"
"1"," 0.0054"
"1"," 0.0001"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [5,]"
"1"," 0.0000"
"1"," 0.0001"
"1"," 0.0032"
"1"," 0.0841"
"1"," 0.8253"
"1"," 0.0841"
"1"," 0.0032"
"1"," 0.0001"
"1"," 0.0000"
"1","
 [6,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0001"
"1"," 0.0054"
"1"," 0.1051"
"1"," 0.8247"
"1"," 0.0630"
"1"," 0.0016"
"1"," 0.0000"
"1","
 [7,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0003"
"1"," 0.0081"
"1"," 0.1261"
"1"," 0.8231"
"1"," 0.0420"
"1"," 0.0005"
"1","
 [8,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0005"
"1"," 0.0113"
"1"," 0.1469"
"1"," 0.8204"
"1"," 0.0209"
"1","
 [9,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0008"
"1"," 0.0150"
"1"," 0.1675"
"1"," 0.8167"
"1","
"
"1","
"
